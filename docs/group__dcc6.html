<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>libgadu: Połączenia bezpośrednie do wersji Gadu-Gadu 6.x</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libgadu
   &#160;<span id="projectnumber">1.12.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Wygenerowano przez Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Szukaj');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Strona&#160;główna</span></a></li>
      <li><a href="pages.html"><span>Dodatkowe&#160;strony</span></a></li>
      <li><a href="modules.html"><span>Moduły</span></a></li>
      <li><a href="annotated.html"><span>Struktury&#160;Danych</span></a></li>
      <li><a href="files.html"><span>Pliki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Szukaj" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Struktury Danych</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Pliki</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funkcje</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Zmienne</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Definicje typów</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Wyliczenia</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Wartości wyliczeń</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Definicje</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Grupay</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Strony</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Struktury danych</a> &#124;
<a href="#func-members">Funkcje</a>  </div>
  <div class="headertitle">
<div class="title">Połączenia bezpośrednie do wersji Gadu-Gadu 6.x<div class="ingroups"><a class="el" href="group__dcc.html">Połączenia bezpośrednie między klientami</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Struktury danych</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgg__dcc.html">gg_dcc</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Połączenie bezpośrednie do wersji Gadu-Gadu 6.x.  <a href="structgg__dcc.html#details">Więcej...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Funkcje</h2></td></tr>
<tr class="memitem:ga2a4b4a2ad85a06ba5f2e9c451dc29b6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#ga2a4b4a2ad85a06ba5f2e9c451dc29b6f">gg_dcc_request</a> (struct <a class="el" href="structgg__session.html">gg_session</a> *sess, <a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a> uin)</td></tr>
<tr class="memdesc:ga2a4b4a2ad85a06ba5f2e9c451dc29b6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wysyła żądanie zwrotnego połączenia bezpośredniego.  <a href="#ga2a4b4a2ad85a06ba5f2e9c451dc29b6f">Więcej...</a><br/></td></tr>
<tr class="separator:ga2a4b4a2ad85a06ba5f2e9c451dc29b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae3da65bbe7c3218cb2e502f021032b68"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#gae3da65bbe7c3218cb2e502f021032b68">gg_dcc_fill_file_info</a> (struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *d, const char *filename)</td></tr>
<tr class="memdesc:gae3da65bbe7c3218cb2e502f021032b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wypełnia pola struktury <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> niezbędne do wysłania pliku.  <a href="#gae3da65bbe7c3218cb2e502f021032b68">Więcej...</a><br/></td></tr>
<tr class="separator:gae3da65bbe7c3218cb2e502f021032b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb0489366604e61863ca167173f16076"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#gacb0489366604e61863ca167173f16076">gg_dcc_fill_file_info2</a> (struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *d, const char *filename, const char *local_filename)</td></tr>
<tr class="memdesc:gacb0489366604e61863ca167173f16076"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wypełnia pola struktury <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> niezbędne do wysłania pliku.  <a href="#gacb0489366604e61863ca167173f16076">Więcej...</a><br/></td></tr>
<tr class="separator:gacb0489366604e61863ca167173f16076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab71b56ab1af27f6c9c45d03d43effea5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#gab71b56ab1af27f6c9c45d03d43effea5">gg_dcc_get_file</a> (uint32_t ip, uint16_t port, <a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a> my_uin, <a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a> peer_uin)</td></tr>
<tr class="memdesc:gab71b56ab1af27f6c9c45d03d43effea5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rozpoczyna odbieranie pliku przez zwrotne połączenie bezpośrednie.  <a href="#gab71b56ab1af27f6c9c45d03d43effea5">Więcej...</a><br/></td></tr>
<tr class="separator:gab71b56ab1af27f6c9c45d03d43effea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e87148a79e8efa4890be95860c425f4"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#ga9e87148a79e8efa4890be95860c425f4">gg_dcc_send_file</a> (uint32_t ip, uint16_t port, <a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a> my_uin, <a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a> peer_uin)</td></tr>
<tr class="memdesc:ga9e87148a79e8efa4890be95860c425f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rozpoczyna wysyłanie pliku.  <a href="#ga9e87148a79e8efa4890be95860c425f4">Więcej...</a><br/></td></tr>
<tr class="separator:ga9e87148a79e8efa4890be95860c425f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga53ac68b8f631a7dff70ba75363a15b2e"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#ga53ac68b8f631a7dff70ba75363a15b2e">gg_dcc_voice_chat</a> (uint32_t ip, uint16_t port, <a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a> my_uin, <a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a> peer_uin)</td></tr>
<tr class="memdesc:ga53ac68b8f631a7dff70ba75363a15b2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rozpoczyna połączenie głosowe.  <a href="#ga53ac68b8f631a7dff70ba75363a15b2e">Więcej...</a><br/></td></tr>
<tr class="separator:ga53ac68b8f631a7dff70ba75363a15b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2b05f4bc46937c62e0794af8b344d9b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#ga2b05f4bc46937c62e0794af8b344d9b4">gg_dcc_set_type</a> (struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *d, int type)</td></tr>
<tr class="memdesc:ga2b05f4bc46937c62e0794af8b344d9b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ustawia typ przychodzącego połączenia bezpośredniego.  <a href="#ga2b05f4bc46937c62e0794af8b344d9b4">Więcej...</a><br/></td></tr>
<tr class="separator:ga2b05f4bc46937c62e0794af8b344d9b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f9f10d4d70adeed7e76423fc047c95e"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#ga1f9f10d4d70adeed7e76423fc047c95e">gg_dcc_socket_create</a> (<a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a> uin, uint16_t port)</td></tr>
<tr class="memdesc:ga1f9f10d4d70adeed7e76423fc047c95e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tworzy gniazdo nasłuchujące dla połączeń bezpośrednich.  <a href="#ga1f9f10d4d70adeed7e76423fc047c95e">Więcej...</a><br/></td></tr>
<tr class="separator:ga1f9f10d4d70adeed7e76423fc047c95e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ec32ead7968e434b54354fe457a8fe1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#ga3ec32ead7968e434b54354fe457a8fe1">gg_dcc_voice_send</a> (struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *d, char *buf, int length)</td></tr>
<tr class="memdesc:ga3ec32ead7968e434b54354fe457a8fe1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wysyła ramkę danych połączenia głosowego.  <a href="#ga3ec32ead7968e434b54354fe457a8fe1">Więcej...</a><br/></td></tr>
<tr class="separator:ga3ec32ead7968e434b54354fe457a8fe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9804ea6dffcb077cd5f7a90d4120dc9b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structgg__event.html">gg_event</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#ga9804ea6dffcb077cd5f7a90d4120dc9b">gg_dcc_watch_fd</a> (struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *h)</td></tr>
<tr class="memdesc:ga9804ea6dffcb077cd5f7a90d4120dc9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funkcja wywoływana po zaobserwowaniu zmian na deskryptorze połączenia.  <a href="#ga9804ea6dffcb077cd5f7a90d4120dc9b">Więcej...</a><br/></td></tr>
<tr class="separator:ga9804ea6dffcb077cd5f7a90d4120dc9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d4489eadc5c531a60a9905894fda6b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dcc6.html#ga5d4489eadc5c531a60a9905894fda6b3">gg_dcc_free</a> (struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *d)</td></tr>
<tr class="memdesc:ga5d4489eadc5c531a60a9905894fda6b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zwalnia zasoby używane przez połączenie bezpośrednie.  <a href="#ga5d4489eadc5c531a60a9905894fda6b3">Więcej...</a><br/></td></tr>
<tr class="separator:ga5d4489eadc5c531a60a9905894fda6b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Opis szczegółowy</h2>
<dl class="section note"><dt>Nota</dt><dd>Funkcje opisane poniżej są zgodne ze starą wersją Gadu-Gadu. Nowy sposób przesyłania plików i przeprowadzania rozmów głosowych, wprowadzony w Gadu-Gadu 7.x, obsługiwany jest <a class="el" href="group__dcc7.html">innymi funkcjami</a>.</dd></dl>
<p>Gadu-Gadu, w przeciwieństwie do protokołów takich jak IRC, umożliwia połączenia w obie strony, bez względu na to, który klient nadaje, a który odbiera. Do tego, jeśli obie strony łączą się do serwera z tego samego <b>publicznego</b> adresu IP, serwer przesyła im ich adresy lokalne.</p>
<p>Ze względu na kierunek i sposób połączenia, wyróżniamy kilka sytuacji:</p>
<ul>
<li>Mamy publiczny lub niepubliczny adres IP i chcemy wysłać plik do osoby z publicznym adresem &ndash; łączymy się z jego klientem, przedstawiamy się, mówimy czego chcemy i jeśli druga strona to zaakceptuje, zaczynam wysyłać plik. Przypomina zwykłe połączenia DCC klientów IRC.</li>
<li>Mamy publiczny adres IP i wysyłam plik do kogoś za NAT &ndash; wysyłamy na jego numer odpowiednią wiadomość przeznaczoną dla klienta (klasa <code>GG_CLASS_CTCP</code>). Druga strona po odebraniu takiego pakietu łączy się znaku o kodzie <code>0x02</code>. druga strona, odebrawszy taki pakiet łączy się z nami, mówi, że proszono ją o połączenie i czeka na dalsze instrukcje. My wtedy wysyłamy informację, że owszem, chcemy wysłać plik, mówimy jaki i jeśli druga strona to zaakceptuje, nadajemy.</li>
<li>Mamy niepubliczny adres IP, tak samo jak i druga strona &ndash; tutaj nawiązanie połączenia jest możliwe tylko i wyłącznie, gdy oba klienty znajdują się w tej samej sieci (tj. oba łączą się z serwerem z tego samego adresu zewnętrznego) i wygląda to wtedy identycznie jak w punkcie pierwszym.</li>
</ul>
<p>To, czy możemy się z kimś połączyć widać po porcie połączeń bezpośrednich drugiej strony, jaki dostajemy w zdarzeniach o zmianie statusu. Jeśli port jest niższy od 10, połączenie nie jest możliwe i należy wysłać specjalną wiadomość za pomocą funkcji <code><a class="el" href="group__dcc6.html#ga2a4b4a2ad85a06ba5f2e9c451dc29b6f" title="Wysyła żądanie zwrotnego połączenia bezpośredniego. ">gg_dcc_request()</a></code>.</p>
<p>Każde połączenie bezpośrednie i gniazdo nasłuchujące opisywane jest przez strukturę <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code>. To ostatnie możemy stworzyć za pomocą:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structgg__dcc.html">gg_dcc</a> *gniazdo;</div>
<div class="line"></div>
<div class="line">gniazdo = <a class="code" href="group__dcc6.html#ga1f9f10d4d70adeed7e76423fc047c95e">gg_dcc_socket_create</a>(numer_gg, port_nasłuchujący);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (!gniazdo)</div>
<div class="line">    błąd(<span class="stringliteral">&quot;Nie można utworzyć gniazda&quot;</span>);</div>
<div class="line"></div>
<div class="line">dodaj_do_obserwowanych(gniazdo);</div>
</div><!-- fragment --><p>Jeśli podamy port 0, libgadu spróbuje znaleźć pierwszy wolny port w okolicy domyślnego portu połączeń bezpośrednich. W przypadku powodzenia zwraca zaalokowaną strukturę <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code>, której najbardziej interesującym polem <code>port</code> zawierające numer przyznanego portu. Jeśli zwróci <code>NULL</code>, w zmiennej systemowej <code>errno</code> znajdzie się powód błędu: <code>EINVAL</code> to niewłaściwie parametry, <code>ENOMEM</code> to brak pamięci, a reszta możliwych błędów to błędy związane z gniazdami, np. <code>EADDRINUSE</code> gdy nie można znaleźć wolnego portu.</p>
<p>Następnie należy w zmiennej globalnej <code>gg_dcc_port</code> ustawić zaalokowany port, do zmiennej <code>gg_dcc_ip</code> wpisać publiczny adres IP i połączyć się z serwerem, żeby poinformować świat o swoich namiarach. Jeśli publiczny adres IP to <code>255.255.255.255</code>, automatycznie jest przypisywany adres IP, z którego wychodzi połączenie do serwera. Należy pamiętać, że wartości tych zmiennych są używane przez <code><a class="el" href="group__login.html#gaf231ccc428422f1b9e14e7c6ed65d1c4" title="Łączy się z serwerem Gadu-Gadu. ">gg_login()</a></code>, więc ich wartości trzeba ustawić przez połączeniem.</p>
<p>Po połączeniu obserwujemy deskryptor gniazda nasłuchującego i gdy coś się pojawi, wywołujemy:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structgg__event.html">gg_event</a> *zdarzenie;</div>
<div class="line"></div>
<div class="line">zdarzenie = <a class="code" href="group__dcc6.html#ga9804ea6dffcb077cd5f7a90d4120dc9b">gg_dcc_watch_fd</a>(gniazdo);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (!zdarzenie) {</div>
<div class="line">    usuń_z_obserwowanych(gniazdo);</div>
<div class="line">    <a class="code" href="group__dcc6.html#ga5d4489eadc5c531a60a9905894fda6b3">gg_dcc_free</a>(gniazdo);</div>
<div class="line">    </div>
<div class="line">    błąd(<span class="stringliteral">&quot;Poważny błąd!&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Błąd jest zwracany tylko w naprawdę krytycznych sytuacjach, gdy brakuje pamięci, lub nie powiodła się operacja na gniazdach, która nie miała się nie powieść (i przy okazji dalsza praca jest kompletnie bezcelowa).</p>
<p>Jeśli błędu nie będzie, dostaniemy informacje o zdarzeniu. W przypadku <code>GG_SESSION_DCC_SOCKET</code> mogą to być:</p>
<ul>
<li><code>GG_EVENT_NONE</code> &ndash; nic ciekawego się nie wydarzyło.</li>
<li><code>GG_EVENT_DCC_ERROR</code> &ndash; wystąpił błąd, którego kod znajduje się w polu <code>dcc_error</code> struktury zdarzenia. W przypadku tego typu sesji możliwy jest tylko G<code>G_ERROR_DCC_HANDSHAKE</code>, który mówi, że nie udało się porozumieć z klientem, który się połączył.</li>
<li><code>GG_EVENT_DCC_NEW</code> &ndash; nowe połączenie bezpośrednie. W polu <code>dcc_new</code> struktury zdarzenia jest struktura <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> typu <code>GG_SESSION_DCC</code>, którą dodajemy do listy obserwowanych.</li>
</ul>
<p>W każdym z tych wypadków należy po sprawdzeniu zdarzenia wywołać funkcję...</p>
<div class="fragment"><div class="line"><a class="code" href="group__events.html#ga1845d4710eede4aaef1c52c4111fbda1">gg_event_free</a>(zdarzenie);</div>
</div><!-- fragment --><p>...by zwolnić pamięć po zdarzeniu.</p>
<dl class="section user"><dt></dt><dd></dd></dl>
<p>Gdy nadejdzie połączenie i dopiszemy je do listy obserwowanych, należy zwracać uwagę na następujące zdarzenia:</p>
<ul>
<li><code>GG_EVENT_NONE</code> &ndash; nic się nie zdarzyło.</li>
<li><code>GG_EVENT_DCC_CLIENT_ACCEPT</code> &ndash; klient się przedstawił i czeka na autoryzację połączenia. Sprawdzamy w strukturze <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> pole <code>uin</code> jest naszym numerem, a <code>peer_uin</code> jest na naszej liście kontaktów i czy chcemy z nim nawiązywać połączenie. Jeśli nie, to po prostu usuwamy połączenie: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (!połączenie_dozwolone(dcc-&gt;uin, dcc-&gt;peer_uin)) {</div>
<div class="line">    usuń_z_obserwowanych(dcc);</div>
<div class="line">    <a class="code" href="group__dcc6.html#ga5d4489eadc5c531a60a9905894fda6b3">gg_dcc_free</a>(dcc);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li><code>GG_EVENT_DCC_CALLBACK</code> &ndash; poprosiliśmy klienta, żeby się z nami połączył za pomocą <a class="el" href="group__dcc6.html#ga2a4b4a2ad85a06ba5f2e9c451dc29b6f" title="Wysyła żądanie zwrotnego połączenia bezpośredniego. ">gg_dcc_request()</a> i on teraz pyta się, czego chcemy. Zaraz po tym zdarzeniu należy wywołać funkcję: <div class="fragment"><div class="line"><a class="code" href="group__dcc6.html#ga2b05f4bc46937c62e0794af8b344d9b4">gg_dcc_set_type</a>(dcc, rodzaj);</div>
</div><!-- fragment --> gdzie <code>connection_type</code> to <code>GG_SESSION_DCC_SEND</code> lub <code>GG_SESSION_DCC_VOICE</code>. Jeśli wysyłamy plik, można od razu wywołać <code><a class="el" href="group__dcc6.html#gae3da65bbe7c3218cb2e502f021032b68" title="Wypełnia pola struktury gg_dcc niezbędne do wysłania pliku. ">gg_dcc_fill_file_info()</a></code>, ale nie jest to wymagane. Kiedy przyjdzie pora, biblioteka sama nas o to poprosi.</li>
<li><code>GG_EVENT_DCC_NEED_FILE_ACK</code> &ndash; klient chce wysłać nam plik. W polu <code>file_info</code> struktury <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> znajdują się wszystkie informacje na temat pliku, jak jego nazwa, rozmiar, atrybuty, data i czas utworzenia itp. Jeśli nie chcemy pliku, zamykamy połączenie w podobny sposób jak przy braku autoryzacji &ndash; zamykamy połączenie, ponieważ biblioteka nie potrafi odpowiadać negatywnie na prośby połączeń bezpośrednich. Jeśli plik nas interesuje, otwieramy lokalnie plik do zapisu i numer jego deskryptora zapisujemy do <code>file_fd</code> w strukturze <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code>. Jeśli chcemy wznowić przerwany transfer, otwieramy plik w trybie dopisywania i do pola <code>offset</code> wpisujemy ile bajtów już mamy. Biblioteka dalej się wszystkim zajmie.</li>
<li><code>GG_EVENT_DCC_NEED_FILE_INFO</code> &ndash; wcześniej poprosiliśmy drugą stronę by się z nami połączyła, bo jest za NAT, a my chcemy wysłać plik. Możemy albo sami wypełnić strukturę <code>file_info</code>, którą biblioteka wyśle drugiej stronie, albo skorzystać z funkcji <code><a class="el" href="group__dcc6.html#gae3da65bbe7c3218cb2e502f021032b68" title="Wypełnia pola struktury gg_dcc niezbędne do wysłania pliku. ">gg_dcc_fill_file_info()</a></code>. <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__dcc6.html#gae3da65bbe7c3218cb2e502f021032b68">gg_dcc_fill_file_info</a>(dcc, nazwa_pliku)) {</div>
<div class="line">    błąd(<span class="stringliteral">&quot;Nie można otworzyć pliku&quot;</span>);</div>
<div class="line">    usuń_z_obserwowanych(dcc);</div>
<div class="line">    <a class="code" href="group__dcc6.html#ga5d4489eadc5c531a60a9905894fda6b3">gg_dcc_free</a>(dcc);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li><code>GG_EVENT_DCC_DONE</code> &ndash; zakończono transfer. Można przestać obserwować deskryptor i zwolnić zasoby po połączeniu.</li>
<li><code>GG_EVENT_DCC_ERROR</code> &ndash; błąd. Możliwy kod błędu to <code>GG_ERROR_DCC_HANDSHAKE</code>, gdy nie powiodło się ustanowienie połączenia z klientem, <code>GG_ERROR_DCC_NET</code> kiedy nie udało się wysłać lub odczytać czegoś z gniazda, <code>GG_ERROR_DCC_FILE</code> gdy nie można było odczytać albo zapisać do pliku, <code>GG_ERROR_DCC_EOF</code> gdy plik lub połączenie zbyt wcześnie się skończy, <code>GG_ERROR_DCC_REFUSED</code> gdy użytkownik po drugiej stronie odmówił połączenia.</li>
</ul>
<p>Tutaj również należy pamiętać o wywoływaniu <code><a class="el" href="group__events.html#ga1845d4710eede4aaef1c52c4111fbda1" title="Zwalnia pamięć zajmowaną przez informację o zdarzeniu. ">gg_event_free()</a></code>.</p>
<dl class="section user"><dt></dt><dd></dd></dl>
<p>Jeśli chcemy sami wysłać plik, sprawdzamy najpierw, czy druga strona może przyjąć połączenie, patrząc na jej port. Jeśli jest wyższy niż 10, możemy śmiało wywołać funkcję:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structgg__dcc.html">gg_dcc</a> *dcc;</div>
<div class="line"></div>
<div class="line">dcc = <a class="code" href="group__dcc6.html#ga9e87148a79e8efa4890be95860c425f4">gg_dcc_send_file</a>(adres_odbiorcy, port_odbiorcy, numer_wlasny, numer_odbiorcy);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (!dcc)</div>
<div class="line">    błąd(<span class="stringliteral">&quot;Nie można ustanowić połączenia&quot;</span>);</div>
</div><!-- fragment --><p>Zaraz potem możemy wywołać funkcję <code><a class="el" href="group__dcc6.html#gae3da65bbe7c3218cb2e502f021032b68" title="Wypełnia pola struktury gg_dcc niezbędne do wysłania pliku. ">gg_dcc_fill_file_info()</a></code>, by uzupełnić informację o pliku...</p>
<div class="fragment"><div class="line"><a class="code" href="group__dcc6.html#gae3da65bbe7c3218cb2e502f021032b68">gg_dcc_fill_file_info</a>(conn, filename);</div>
</div><!-- fragment --><p>...ale jeśli tego nie zrobimy teraz, biblioteka poprosi nas o to w odpowiedniej za pomocą zdarzenia <code>GG_EVENT_DCC_NEED_FILE_INFO</code>.</p>
<p>Jeśli port jest podejrzanie niski, znaczy że połączenie jest niemożliwe i wtedy wywołujemy funkcję:</p>
<div class="fragment"><div class="line"><a class="code" href="group__dcc6.html#ga2a4b4a2ad85a06ba5f2e9c451dc29b6f">gg_dcc_request</a>(sesja, numer_odbiorcy);</div>
</div><!-- fragment --><p>gdzie <code>session</code> to nasza sesja Gadu-Gadu (musi być połączona), a <code>peer_uin</code> to numer drugiej strony. Wiadomość spowoduje, że druga strona spróbuje się z nami połączyć, jeśli ma taką możliwość.</p>
<dl class="section user"><dt></dt><dd></dd></dl>
<p>Gdy otrzymamy wiadomość klasy <code>GG_CLASS_CTCP</code> o treści składającej się z bajtu 0x02 znaczy, że ktoś chce nam coś przesłać i mamy się z nim połączyć. Wywołujemy wtedy:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structgg__dcc.html">gg_dcc</a> *dcc;</div>
<div class="line"></div>
<div class="line">dcc = <a class="code" href="group__dcc6.html#gab71b56ab1af27f6c9c45d03d43effea5">gg_dcc_get_file</a>(adres_nadawcy, port_nadawcy, numer_wlasny, numer_nadawcy);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (!dcc)</div>
<div class="line">    błąd(<span class="stringliteral">&quot;Nie można ustanowić połączenia&quot;</span>);</div>
</div><!-- fragment --><p>Dalej tak samo, jak przy zwykłym odbieraniu pliku. </p>
<h2 class="groupheader">Dokumentacja funkcji</h2>
<a class="anchor" id="ga2a4b4a2ad85a06ba5f2e9c451dc29b6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gg_dcc_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgg__session.html">gg_session</a> *&#160;</td>
          <td class="paramname"><em>sess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a>&#160;</td>
          <td class="paramname"><em>uin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wysyła żądanie zwrotnego połączenia bezpośredniego. </p>
<p>Funkcję wykorzystuje się, jeśli nie ma możliwości połączenia się z odbiorcą pliku lub rozmowy głosowej. Po otrzymaniu żądania druga strona spróbuje nawiązać zwrotne połączenie bezpośrednie z nadawcą. <a class="el" href="group__dcc6.html#ga2a4b4a2ad85a06ba5f2e9c451dc29b6f" title="Wysyła żądanie zwrotnego połączenia bezpośredniego. ">gg_dcc_request()</a></p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">sess</td><td>Struktura sesji </td></tr>
    <tr><td class="paramname">uin</td><td>Numer odbiorcy</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Zwraca</dt><dd>Patrz <code><a class="el" href="group__messages.html#ga2c03e907a237f1de9a0e22b252e333c5" title="Wysyła wiadomość binarną przeznaczoną dla klienta. ">gg_send_message_ctcp()</a></code> </dd></dl>

</div>
</div>
<a class="anchor" id="gae3da65bbe7c3218cb2e502f021032b68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gg_dcc_fill_file_info </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wypełnia pola struktury <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> niezbędne do wysłania pliku. </p>
<dl class="section note"><dt>Nota</dt><dd>Większą funkcjonalność zapewnia funkcja <code><a class="el" href="group__dcc6.html#gacb0489366604e61863ca167173f16076" title="Wypełnia pola struktury gg_dcc niezbędne do wysłania pliku. ">gg_dcc_fill_file_info2()</a></code>.</dd></dl>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Struktura połączenia </td></tr>
    <tr><td class="paramname">filename</td><td>Nazwa pliku</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Zwraca</dt><dd>0 jeśli się powiodło, -1 w przypadku błędu </dd></dl>

</div>
</div>
<a class="anchor" id="gacb0489366604e61863ca167173f16076"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gg_dcc_fill_file_info2 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>local_filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wypełnia pola struktury <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> niezbędne do wysłania pliku. </p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Struktura połączenia </td></tr>
    <tr><td class="paramname">filename</td><td>Nazwa pliku zapisywana w strukturze </td></tr>
    <tr><td class="paramname">local_filename</td><td>Nazwa pliku w lokalnym systemie plików</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Zwraca</dt><dd>0 jeśli się powiodło, -1 w przypadku błędu </dd></dl>

</div>
</div>
<a class="anchor" id="gab71b56ab1af27f6c9c45d03d43effea5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgg__dcc.html">gg_dcc</a>* gg_dcc_get_file </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a>&#160;</td>
          <td class="paramname"><em>my_uin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a>&#160;</td>
          <td class="paramname"><em>peer_uin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rozpoczyna odbieranie pliku przez zwrotne połączenie bezpośrednie. </p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>Adres IP nadawcy </td></tr>
    <tr><td class="paramname">port</td><td>Port nadawcy </td></tr>
    <tr><td class="paramname">my_uin</td><td>Własny numer </td></tr>
    <tr><td class="paramname">peer_uin</td><td>Numer nadawcy</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Zwraca</dt><dd>Struktura <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> lub <code>NULL</code> w przypadku błędu </dd></dl>

</div>
</div>
<a class="anchor" id="ga9e87148a79e8efa4890be95860c425f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgg__dcc.html">gg_dcc</a>* gg_dcc_send_file </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a>&#160;</td>
          <td class="paramname"><em>my_uin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a>&#160;</td>
          <td class="paramname"><em>peer_uin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rozpoczyna wysyłanie pliku. </p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>Adres IP odbiorcy </td></tr>
    <tr><td class="paramname">port</td><td>Port odbiorcy </td></tr>
    <tr><td class="paramname">my_uin</td><td>Własny numer </td></tr>
    <tr><td class="paramname">peer_uin</td><td>Numer odbiorcy</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Zwraca</dt><dd>Struktura <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> lub <code>NULL</code> w przypadku błędu </dd></dl>

</div>
</div>
<a class="anchor" id="ga53ac68b8f631a7dff70ba75363a15b2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgg__dcc.html">gg_dcc</a>* gg_dcc_voice_chat </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a>&#160;</td>
          <td class="paramname"><em>my_uin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a>&#160;</td>
          <td class="paramname"><em>peer_uin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rozpoczyna połączenie głosowe. </p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>Adres IP odbiorcy </td></tr>
    <tr><td class="paramname">port</td><td>Port odbiorcy </td></tr>
    <tr><td class="paramname">my_uin</td><td>Własny numer </td></tr>
    <tr><td class="paramname">peer_uin</td><td>Numer odbiorcy</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Zwraca</dt><dd>Struktura <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> lub <code>NULL</code> w przypadku błędu </dd></dl>

</div>
</div>
<a class="anchor" id="ga2b05f4bc46937c62e0794af8b344d9b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gg_dcc_set_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ustawia typ przychodzącego połączenia bezpośredniego. </p>
<p>Funkcję należy wywołać po otrzymaniu zdarzenia <code>GG_EVENT_DCC_CALLBACK</code>.</p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Struktura połączenia </td></tr>
    <tr><td class="paramname">type</td><td>Rodzaj połączenia (<code>GG_SESSION_DCC_SEND</code> lub <code>GG_SESSION_DCC_VOICE</code>) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1f9f10d4d70adeed7e76423fc047c95e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgg__dcc.html">gg_dcc</a>* gg_dcc_socket_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libgadu_8h.html#a33f630ba74294027f9bcda26ed49cdc8">uin_t</a>&#160;</td>
          <td class="paramname"><em>uin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tworzy gniazdo nasłuchujące dla połączeń bezpośrednich. </p>
<p>Funkcja przywiązuje gniazdo do pierwszego wolnego portu TCP.</p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">uin</td><td>Własny numer </td></tr>
    <tr><td class="paramname">port</td><td>Preferowany port (jeśli równy 0 lub -1, próbuje się domyślnego)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Nota</dt><dd>Ze względu na możliwość podania wartości -1 do parametru będącego 16-bitową liczbą bez znaku, port 65535 nie jest dostępny.</dd></dl>
<dl class="section return"><dt>Zwraca</dt><dd>Struktura <code><a class="el" href="structgg__dcc.html" title="Połączenie bezpośrednie do wersji Gadu-Gadu 6.x. ">gg_dcc</a></code> lub <code>NULL</code> w przypadku błędu </dd></dl>

</div>
</div>
<a class="anchor" id="ga3ec32ead7968e434b54354fe457a8fe1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gg_dcc_voice_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wysyła ramkę danych połączenia głosowego. </p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Struktura połączenia </td></tr>
    <tr><td class="paramname">buf</td><td>Bufor z danymi </td></tr>
    <tr><td class="paramname">length</td><td>Długość bufora z danymi</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Zwraca</dt><dd>0 jeśli się powiodło, -1 w przypadku błędu </dd></dl>

</div>
</div>
<a class="anchor" id="ga9804ea6dffcb077cd5f7a90d4120dc9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgg__event.html">gg_event</a>* gg_dcc_watch_fd </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funkcja wywoływana po zaobserwowaniu zmian na deskryptorze połączenia. </p>
<p>Funkcja zwraca strukturę zdarzenia <code><a class="el" href="structgg__event.html" title="Opis zdarzenia. ">gg_event</a></code>. Jeśli rodzaj zdarzenia to <code>GG_EVENT_NONE</code>, nie wydarzyło się jeszcze nic wartego odnotowania. Strukturę zdarzenia należy zwolnić funkcja <code>gg_event_free</code>.</p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Struktura połączenia</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Zwraca</dt><dd>Struktura zdarzenia lub <code>NULL</code> jeśli wystąpił błąd </dd></dl>

</div>
</div>
<a class="anchor" id="ga5d4489eadc5c531a60a9905894fda6b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gg_dcc_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgg__dcc.html">gg_dcc</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zwalnia zasoby używane przez połączenie bezpośrednie. </p>
<dl class="params"><dt>Parametry</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>Struktura połączenia </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Wygenerowano Śr, 1 lut 2017 09:11:02 dla libgadu programem &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
